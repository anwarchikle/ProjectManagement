<template>
    <lightning-card title="Retest & Verification">

        <!-- ============================= -->
        <!-- STATUS CARDS -->
        <!-- ============================= -->
        <lightning-layout multiple-rows="true" class="slds-m-bottom_medium">

            <lightning-layout-item size="12" small-device-size="6" medium-device-size="3" large-device-size="3" padding="around-small">
                <div class="status-card pending">
                    <lightning-icon icon-name="standard:queue" size="small"></lightning-icon>
                    <span class="status-label">Pending Retest</span>
                    <div class="status-count">{pendingCount}</div>
                </div>
            </lightning-layout-item>

            <lightning-layout-item size="12" small-device-size="6" medium-device-size="3" large-device-size="3" padding="around-small">
                <div class="status-card fixed">
                    <lightning-icon icon-name="standard:fix" size="small"></lightning-icon>
                    <span class="status-label">Retesting Fixed</span>
                    <div class="status-count">{fixedCount}</div>
                </div>
            </lightning-layout-item>

            <lightning-layout-item size="12" small-device-size="6" medium-device-size="3" large-device-size="3" padding="around-small">
                <div class="status-card retest">
                    <lightning-icon icon-name="standard:retail_banking" size="small"></lightning-icon>
                    <span class="status-label">In Retest</span>
                    <div class="status-count">{totalRetestRecordsCount}</div>
                </div>
            </lightning-layout-item>

            <lightning-layout-item size="12" small-device-size="6" medium-device-size="3" large-device-size="3" padding="around-small">
                <div class="status-card atrisk">
                    <lightning-icon icon-name="standard:outage" size="small"></lightning-icon>
                    <span class="status-label">SLA at Risk</span>
                    <div class="status-count">{slaAtRiskCount}</div>
                </div>
            </lightning-layout-item>

        </lightning-layout>

        <!-- ============================= -->
        <!-- HEADER + SEARCH -->
        <!-- ============================= -->
        <lightning-layout vertical-align="center" multiple-rows="true" class="slds-m-bottom_medium">

            <lightning-layout-item size="12" medium-device-size="6">
                <h2 class="header-title">{selectedListViewLabel}</h2>
            </lightning-layout-item>

            <lightning-layout-item size="12" medium-device-size="6" class="search-container">
                <lightning-input 
                    type="search"
                    placeholder="Search..."
                    value={searchKey}
                    onchange={handleSearchChange}>
                </lightning-input>
            </lightning-layout-item>

        </lightning-layout>

        <!-- ============================= -->
        <!-- DATA TABLE -->
        <!-- ============================= -->
        <div class="table-wrapper">
            <template if:true={visibleRecords}>
                <table class="slds-table slds-table_cell-buffer slds-table_bordered">
                    <thead>
                        <tr>
                            <template for:each={Newcolumns} for:item="col">
                                <th key={col.fieldApiName}>
                                    {col.label}
                                </th>
                            </template>
                            <th>Result</th>
                        </tr>
                    </thead>

                    <tbody>
                        <template for:each={visibleRecords} for:item="row">
                            <tr key={row.Id}>

                                <template for:each={row.cells} for:item="cell">
                                    <td key={cell.fieldApiName}>
                                        <template if:true={cell.isLink}>
                                            <a href={cell.url} target="_blank">
                                                {cell.value}
                                            </a>
                                        </template>
                                        <template if:false={cell.isLink}>
                                            {cell.value}
                                        </template>
                                    </td>
                                </template>

                                <td>
                                    <lightning-button-group class="mobile-btn-group">
                                        <lightning-button
                                            variant="success"
                                            label="Pass"
                                            data-id={row.Id}
                                            onclick={handlePassClick}>
                                        </lightning-button>

                                        <lightning-button
                                            variant="destructive-text"
                                            label="Fail"
                                            data-id={row.Id}
                                            onclick={handleFailClick}>
                                        </lightning-button>
                                    </lightning-button-group>
                                </td>

                            </tr>
                        </template>
                    </tbody>
                </table>
            </template>

            <template if:false={visibleRecords}>
                <div class="empty-state">
                    <lightning-icon icon-name="standard:empty" size="small"></lightning-icon>
                    <span>No items in {selectedListViewLabel}</span>
                </div>
            </template>
        </div>

        <!-- ============================= -->
        <!-- PAGINATION -->
        <!-- ============================= -->
        <div class="pagination-container">
            <lightning-button 
                label="Previous"
                onclick={handlePreviousPage}
                disabled={isPreviousDisabled}>
            </lightning-button>

            <lightning-button 
                label="Next"
                onclick={handleNextPage}
                disabled={isNextDisabled}>
            </lightning-button>
        </div>

        <!-- ============================= -->
        <!-- MODAL -->
        <!-- ============================= -->
        <template if:true={showModal}>
            <!-- Your existing modal code -->
        </template>

    </lightning-card>
</template>